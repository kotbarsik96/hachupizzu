let cart={},cartAmount={};function loadCartFromStorage(){null!=JSON.parse(localStorage.getItem("cart"))&&(cart=JSON.parse(localStorage.getItem("cart"))),null!=JSON.parse(localStorage.getItem("cartAmount"))&&(cartAmount=JSON.parse(localStorage.getItem("cartAmount")))}function loadCartToStorage(){null!=cart&&localStorage.setItem("cart",JSON.stringify(cart)),null!=cartAmount&&localStorage.setItem("cartAmount",JSON.stringify(cartAmount))}function renderCart(){for(let i in cart){if(0==cart[i].rendered&&"pizza"==cart[i].type){let t="";if(t+='<li class="menu_product_item" id="'+i+'" data-prod-type="'+cart[i].type+'"><div class="product_item_wrapper"><div class="menu_item_head"><div class="menu_item_head_wrapper">',t+='<h3 class="option_name">'+cart[i].name+"</h3>",t+='<div class="menu_item_price">'+cart[i].price+"</div>",t+='<div class="menu_item_image"><div class="item_image"><img src="'+cart[i].image+'"></div>',t+='<div class="item_cart"><div class="item_plus_image item_minus_image"><label for="'+i+'_remove" title="Нажмите, чтобы убрать из корзины"></label>',t+='<input id="'+i+'_remove" type="button" class="hidden_submit"></div>',t+='<div class="item_cart_image"></div></div></div></div></div>',t+='<div class="menu_item_body"><div class="item_body_description_wrapper"><div class="item_body_order_wrapper"><div class="item_body_order">',cart[i].options.ingreds.length>0){t+='<div class="product_ingreds_container product_option_container"><div class="option_header"><h3 class="option_name _grey_name">Ингридиенты</h3></div><div class="product_ingreds product_option"><ul class="selected_options_list">';for(let e of cart[i].options.ingreds)t+="<li>"+$('label[for="'+e+'"]').text()+"</li>";t+="</ul></div></div>"}t+='<div class="product_dough_container product_option_container"><div class="option_header"><h3 class="option_name _grey_name">Тесто</h3></div><div class="product_dough product_option"><ul class="selected_options_list">';for(let e of cart[i].options.dough)t+="<li>"+$('label[for="'+e+'"]').text()+"</li>";t+="</ul></div></div>",t+='<div class="product_size_and_slice">',t+='<div class="product_size_container product_option_container"><div class="option_header"><h3 class="option_name _grey_name">Размер</h3></div><div class="product_size product_option"><ul class="selected_options_list">';for(let e of cart[i].options.size)t+="<li>"+$('label[for="'+e+'"]').text()+"</li>";t+="</ul></div></div>",t+='<div class="product_slice_container product_option_container"><div class="option_header"><h3 class="option_name _grey_name">Нарезка</h3></div><div class="product_slice product_option"><ul class="selected_options_list">';for(let e of cart[i].options.slice)t+="<li>"+$('label[for="'+e+'"]').text()+"</li>";t+="</ul></div></div>",t+="</div></form></div></div></div></li>",$(".orders_list").append(t),cart[i].rendered=!0,$("#"+i+"_remove").on("click",(function(){removeFromCart(i)}))}if(0==cart[i].rendered&&"drink"==cart[i].type){let t="";if(t+='<li class="menu_product_item" id="'+i+'" data-prod-type="'+cart[i].type+'"><div class="product_item_wrapper"><div class="menu_item_head"><div class="menu_item_head_wrapper">',t+='<h3 class="menu_item_name">'+cart[i].name+"</h3>",t+='<div class="menu_item_price">'+cart[i].price+"</div>",t+='<div class="menu_item_image"><div class="item_image drink_image _no_hover"><img src="'+cart[i].image+'" alt="'+i+'"></div>',t+='<div class="item_cart"><div class="item_plus_image item_minus_image"><label for="'+i+'_remove" title="Нажмите, чтобы убрать из корзины"></label>',t+='<input type="button" id="'+i+'_remove"></div>',t+='<div class="item_cart_image"></div></div></div></div></div>',t+='<div class="menu_item_body" id="'+i+'_body_borders"><div class="item_body_wrapper">',null!=cart[i].options.size[0]){t+='<div class="item_body_size item_body_option _bottom_border"><div class="drink_option_header"><h3 class="option_name _grey_name">Размер</h3></div>',t+='<div class="drink_option_size drink_option"><ul>';for(let e of cart[i].options.size)t+="<li>"+$('label[for="'+e+'"]').text()+"</li>";t+="</ul></div></div>"}if(null!=cart[i].options.taste[0]){t+='<div class="item_body_taste item_body_option _bottom_border"><div class="drink_option_header"><h3 class="option_name _grey_name">Вкус</h3></div>',t+='<div class="drink_option_taste drink_option"><ul>';for(let e of cart[i].options.taste)t+="<li>"+$('label[for="'+e+'"]').text()+"</li>";t+="</ul></div></div>"}if(null!=cart[i].options.additional[0]){t+='<div class="item_body_additional item_body_option"><div class="drink_option_header"><h3 class="option_name _grey_name">Дополнительно</h3></div>',t+='<div class="drink_option_additional drink_option"><ul>';for(let e of cart[i].options.additional)t+="<li>"+$('label[for="'+e+'"]').text()+"</li>";t+="</ul></div></div>"}t+="</div></div></div></li>",$(".orders_list").append(t);let e=$("#"+i+"_body_borders").children().children();2==e.length&&e[1].classList.remove("_bottom_border"),cart[i].rendered=!0,$("#"+i+"_remove").on("click",(function(){removeFromCart(i)}))}}countProducts()}function addToCart(i){let t=$("#"+i+"_form");null==cartAmount[i]?cartAmount[i]=1:cartAmount[i]++;let e=i+cartAmount[i];for(let t in cart)if(t==e)do{e=i+cartAmount[i],cartAmount[i]++}while(t==e);if(cart[e]={},cart[e].name=$("#"+i+"_name").text(),cart[e].price=$("#"+i+"_price").text(),cart[e].image=$("#"+i+"_image").children("img").attr("src"),cart[e].rendered=!1,cart[e].number=e.slice(e.length-1),cart[e].type=t.attr("data-product-type"),"pizza"==cart[e].type){cart[e].options={ingreds:[],dough:[],size:[],slice:[]};for(let i of t.children(".ingreds_checkbox").children("input:checked"))cart[e].options.ingreds.push(i.getAttribute("id"));for(let i of t.children(".dough_checkbox").children("input:checked"))cart[e].options.dough.push(i.getAttribute("id"));for(let i of t.children(".size_checkbox").children("input:checked"))cart[e].options.size.push(i.getAttribute("id"));for(let i of t.children(".slice_checkbox").children("input:checked"))cart[e].options.slice.push(i.getAttribute("id"))}if("drink"==cart[e].type){cart[e].options={size:[],taste:[],additional:[]};for(let i of t.children(".size_checkbox").children("input:checked"))cart[e].options.size.push(i.getAttribute("id"));for(let i of t.children(".taste_checkbox").children("input:checked"))cart[e].options.taste.push(i.getAttribute("id"));for(let i of t.children(".additional_checkbox").children("input:checked"))cart[e].options.additional.push(i.getAttribute("id"))}loadCartToStorage(),loadCartFromStorage(),renderCart()}function removeFromCart(i){delete cart[i],cartAmount[i.substring(0,i.length-1)]=1,loadCartToStorage(),loadCartFromStorage(),$("#"+i).addClass("_removed"),setTimeout((()=>{$("#"+i).remove(),renderCart()}),1200)}function filterCart(){let i=$("#filter_button"),t=i.val(),e=i.children(),o=$(".menu_product_item"),d=$(".filter_button_image");if("all"!=i.val()){d.addClass("_active");for(let i of e)if(i.value==t)for(let t of o){let e=t.getAttribute("data-prod-type");null!=e&&e==i.value&&t.classList.remove("_hidden")}else if("all"!=i.value)for(let t of o){let e=t.getAttribute("data-prod-type");null!=e&&e==i.value&&t.classList.add("_hidden")}}if("all"==i.val()){for(let i of o){null!=i.getAttribute("data-prod-type")&&i.classList.remove("_hidden")}d.removeClass("_active")}countProducts()}function countProducts(){let i=$(".orders_list").children("li:not(._hidden)"),t=i.length;t>0?$("#nothing_here").addClass("_hidden"):$("#nothing_here").removeClass("_hidden");let e=0;for(let t of i){let i=cart[t.id].price;e+=parseInt(i.replace(" рублей",""))}1==t?$("#orders_count").text(t+" товар"):t<5&&0!=t?$("#orders_count").text(t+" товара"):$("#orders_count").text(t+" товаров"),$("#orders_totalprice").text(e+" рублей")}$(document).ready((function(){loadCartFromStorage(),setTimeout((()=>{for(let i in cart)cart[i].rendered=!1;renderCart()}),500),setTimeout((()=>{loadProducts.pizza(),loadProducts.drinks()}),0),filterCart(),$("#filter_button").on("change",(function(){filterCart()}))}));let loadProducts={pizza:function(){$.getJSON("../javascript/JSON/pizza.json",(function(i){let t="";for(let e in i){t+='<li class="menu_product_item" data-product-id="'+i[e].id+'"><div class="product_item_wrapper"><div class="menu_item_head"><div class="menu_item_head_wrapper">',t+='<h3 class="option_name menu_item_name" id="'+i[e].id+'_name">'+i[e].name+"</h3>",t+='<div class="menu_item_price" id="'+i[e].id+'_price" value="'+i[e].price+'"> </div>',t+='<div class="menu_item_image"><div class="item_image pizza_image _hover" id="'+i[e].id+'_image"><img src="'+i[e].image+'" alt="'+i[e].id+'"></div>',t+='<div class="item_cart"><div class="item_plus_image"><label for="'+i[e].id+'_order" title="Нажмите, чтобы добавить в корзину"></label></div><div class="item_cart_image"></div>',t+="</div></div></div></div>",t+='<div class="menu_item_body" id="'+i[e].id+'_body"><div class="item_body_description_wrapper"><div class="item_body_description">'+i[e].description+"</div></div>",t+='<div class="item_body_order_wrapper"><form action="#" class="item_body_order" id="'+i[e].id+'_form" data-product-type="'+i[e].type+'">',t+='<div class="product_ingreds_container product_option_container"><div class="option_header"><h3 class="option_name">Ингридиенты</h3></div>',t+='<div class="product_ingreds product_option">',t+='<ul id="'+i[e].id+'_ingreds">';for(let o in i[e].options.ingreds)t+='<li><label for="'+i[e].options.ingreds[o].input+'">'+i[e].options.ingreds[o].text+"</label>";t+="</ul></div></div>",t+='<div class="product_dough_container product_option_container"><div class="option_header"><h3 class="option_name">Тесто</h3></div>',t+='<div class="product_dough product_option">',t+='<ul id="'+i[e].id+'_dough">';for(let o in i[e].options.dough)t+='<li><label for="'+i[e].options.dough[o].input+'">'+i[e].options.dough[o].text+"</label>";t+="</ul></div></div>",t+='<div class="product_size_and_slice">',t+='<div class="product_size_container product_option_container"><div class="option_header"><h3 class="option_name">Размер</h3></div>',t+='<div class="product_size product_option">',t+='<ul id="'+i[e].id+'_size">';for(let o in i[e].options.size)t+='<li><label for="'+i[e].options.size[o].input+'">'+i[e].options.size[o].text+"</label>";t+="</ul></div></div>",t+='<div class="product_slice_container product_option_container"><div class="option_header"><h3 class="option_name">Нарезка</h3></div>',t+='<div class="product_slice product_option">',t+='<ul id="'+i[e].id+'_slice">';for(let o in i[e].options.slice)t+='<li><label for="'+i[e].options.slice[o].input+'">'+i[e].options.slice[o].text+"</label>";t+="</ul></div></div></div>",t+='<input id="'+i[e].id+'_order" type="button" class="hidden_submit">',t+='<div class="checkbox_option ingreds_checkbox" data-opt-name="ingreds">';for(let o in i[e].options.ingreds)t+='<input type="checkbox" id="'+i[e].options.ingreds[o].input+'" name="ingred" value="'+i[e].options.ingreds[o].value+'" class="hidden_submit">';t+="</div>",t+='<div class="checkbox_option dough_checkbox" data-opt-name="dough">';for(let o in i[e].options.dough)t+='<input type="radio" id="'+i[e].options.dough[o].input+'" name="dough" value="'+i[e].options.dough[o].value+'" class="hidden_submit"'+i[e].options.dough[o].checked+">";t+="</div>",t+='<div class="checkbox_option size_checkbox" data-opt-name="size" id="'+i[e].id+'_size_checkbox">';for(let o in i[e].options.size)t+='<input type="radio" id="'+i[e].options.size[o].input+'" name="size" value="'+i[e].options.size[o].value+'" class="hidden_submit"'+i[e].options.size[o].checked,index=i[e].options.size[o].blocks,null!=index?t+=' data-block-options="'+index+'">':t+=">";t+="</div>",t+='<div class="checkbox_option slice_checkbox" data-opt-name="slice" id="'+i[e].id+'_slice_checkbox">';for(let o in i[e].options.slice)t+='<input type="radio" id="'+i[e].options.slice[o].input+'" name="slice" value="'+i[e].options.slice[o].value+'" class="hidden_submit"'+i[e].options.slice[o].checked+">";t+="</div>",t+="</form></div></div></div></li>"}$("#pizza_list").append(t);for(let t in i)$("#"+i[t].id+"_order").on("click",(function(){addToCart(i[t].id)}))}))},drinks:function(){$.getJSON("../javascript/JSON/drinks.json",(function(i){let t="";for(let e in i){if(t+='<li class="menu_product_item" data-product-id="'+i[e].id+'"><div class="product_item_wrapper"><div class="menu_item_head"><div class="menu_item_head_wrapper">',t+='<h3 class="menu_item_name" id="'+i[e].id+'_name">'+i[e].name+"</h3>",t+='<div class="menu_item_price" id="'+i[e].id+'_price" value="'+i[e].price+'"></div>',t+='<div class="menu_item_image"><div class="item_image drink_image _no_hover" id="'+i[e].id+'_image"><img src="'+i[e].image+'" alt="'+i[e].id+'"></div>',t+='<div class="item_cart"><div class="item_plus_image"><label for="'+i[e].id+'_order" title="Нажмите, чтобы добавить в корзину"></label></div><div class="item_cart_image"></div>',t+="</div></div></div></div>",t+='<div class="menu_item_body _drink_body"><form id="'+i[e].id+'_form" class="item_body_wrapper" data-product-type="'+i[e].type+'">',t+='<div class="item_body_slogan item_body_option"><div class="slogan_wrapper"><div class="slogan_text">'+i[e].slogan+"</div></div></div>",null!=i[e].options.size){t+='<div class="item_body_size item_body_option"><div class="drink_option_header"><h3 class="option_name">Размер</h3></div><div class="drink_option_size drink_option"><ul id="'+i[e].id+'_size">';for(let o in i[e].options.size)t+='<li><label for="'+i[e].options.size[o].input+'">'+i[e].options.size[o].text+"</label></li>";t+="</ul></div></div>"}if(null!=i[e].options.taste){t+='<div class="item_body_taste item_body_option"><div class="drink_option_header"><h3 class="option_name">Вкус</h3></div><div class="drink_option_taste drink_option"><ul id="'+i[e].id+'_taste">';for(let o in i[e].options.taste)t+='<li><label for="'+i[e].options.taste[o].input+'">'+i[e].options.taste[o].text+"</label></li>";t+="</ul></div></div>"}if(null!=i[e].options.additional){t+='<div class="item_body_additional item_body_option"><div class="drink_option_header"><h3 class="option_name">Дополнительно</h3></div><div class="drink_option_additional drink_option"><ul id="'+i[e].id+'_additional">';for(let o in i[e].options.additional)t+='<li><label for="'+i[e].options.additional[o].input+'">'+i[e].options.additional[o].text+"</label></li>";t+="</ul></div></div>"}t+='<input type="button" class="hidden_submit" id="'+i[e].id+'_order">',t+='<div class="checkbox_option size_checkbox" data-opt-name="size" id="'+i[e].id+'_size_checkbox">';for(let o in i[e].options.size){t+='<input type="radio" name="size" class="hidden_submit" id="'+i[e].options.size[o].input+'" value="'+i[e].options.size[o].value+'"';let d=i[e].options.size[o].blocks;null!=d&&(t+='data-block-options="'+d+'" ');let a=i[e].options.size[o].blocks;null!=a&&(t+='data-unlock-options="'+a+'" '),null!=i[e].options.size[o].image?t+='data-img-size="'+i[e].options.size[o].image+'"'+i[e].options.size[o].checked+">":t+=i[e].options.size[o].checked+">"}t+="</div>",t+='<div class="checkbox_option taste_checkbox" data-opt-name="taste" id="'+i[e].id+'_taste_checkbox">';for(let o in i[e].options.taste){t+='<input type="radio" name="taste" class="hidden_submit" id="'+i[e].options.taste[o].input+'" value="'+i[e].options.taste[o].value+'"';let d=i[e].options.taste[o].blocks;null!=d&&(t+='data-block-options="'+d+'" ');let a=i[e].options.taste[o].unlocks;null!=a&&(t+='data-unlock-options="'+a+'" '),null!=i[e].options.taste[o].image?t+='data-img-taste="'+i[e].options.taste[o].image+'"'+i[e].options.taste[o].checked+">":t+=i[e].options.taste[o].checked+">"}t+="</div>",t+='<div class="checkbox_option additional_checkbox" data-opt-name="additional" id="'+i[e].id+'_additional_checkbox">';for(let o in i[e].options.additional){t+='<input type="radio" name="additional" class="hidden_submit" id="'+i[e].options.additional[o].input+'" value="'+i[e].options.additional[o].value+'"';let d=i[e].options.additional[o].blocks;null!=d&&(t+='data-block-options="'+d+'" ');let a=i[e].options.additional[o].blocks;null!=a&&(t+='data-unlock-options="'+a+'" '),null!=i[e].options.additional[o].image?t+='data-img-additional="'+i[e].options.additional[o].image+'"'+i[e].options.additional[o].checked+">":t+=i[e].options.additional[o].checked+">"}t+="</div>",t+="</form></div></div></li>"}$("#drinks_list").append(t);for(let t in i)$("#"+i[t].id+"_order").on("click",(function(){addToCart(i[t].id)}))}))}};
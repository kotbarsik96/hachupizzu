$(document).ready((function(){setTimeout((()=>{let e=navigator.userAgent.toLowerCase();if(1==/firefox/.test(e)){let e=document.querySelectorAll(".menu_item_body");for(let t of e)t.style.backfaceVisibility="hidden"}let t=window.innerWidth-document.querySelector(".wrapper_fullscreen").offsetWidth;window.addEventListener("resize",(function(){t=window.innerWidth-document.querySelector(".wrapper_fullscreen").offsetWidth}));let i=new class{constructor(){this.animItem=document.querySelector("#shopping_cart"),this.animItemHeight=this.animItem.offsetHeight,this.animItemOffset=this.offset(this.animItem).top,this.animItemStart=3,this.animItemPoint=window.innerHeight-this.animItemOffset/this.animItemStart,this.positionItem1=document.querySelector(".menu_products"),this.positionItem2=document.querySelector(".menu_products_list")}toFixPosition(){pageYOffset>this.animItemPoint-this.animItemHeight?this.animItem.classList.add("_fixed"):this.animItem.classList.remove("_fixed"),this.toCenterItem()}toCenterItem(){const e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t=document.querySelector(".header_menu");if(e>1430){let e=document.querySelector(".menu_products_list"),i=(document.querySelector(".wrapper_fullscreen").offsetWidth-e.offsetWidth)/8;this.animItem.style.marginRight=i+"px",this.animItem.style.marginLeft=i+"px",t.style.marginTop=0}else if(e<1430){let i=document.querySelector(".menu_product_item"),n=(document.querySelector(".wrapper_fullscreen").offsetWidth-i.offsetWidth)/8;this.animItem.style.marginLeft=n+"px",this.animItem.style.marginRight=n/6+"px",t.style.marginTop=0,e<1200&&(t.style.marginTop=this.animItem.offsetHeight+"px",this.animItem.style.marginRight=n/6+"px"),e<992&&e>767&&(this.animItem.style.marginRight=n+"px"),e<767&&(this.animItem.style.marginRight=n/3+"px")}}offset(e){const t=e.getBoundingClientRect(),i=(window.pageXOffset||document.documentElement.scrollLeft,window.pageYOffset||document.documentElement.scrollTop);return{top:t.top+i,left:t.left+scroll.left}}showCartContent(){const e=document.querySelector("#shopping_cart"),i=document.querySelector("#shopping_cart_dark_background"),n=document.querySelector("#shopping_cart_content"),o=document.querySelector("body");e.addEventListener("click",(function(){n.classList.contains("_active")||n.classList.add("_active"),i.classList.contains("_active")||i.classList.add("_active"),o.classList.contains("_no_scroll")||(o.classList.add("_no_scroll"),o.style.paddingRight=t+"px"),e.classList.contains("_transformed")||e.classList.add("_transformed")}))}closeCartContent(){const e=document.querySelector("#shopping_cart"),t=document.querySelector("#cart_content_close"),i=document.querySelector("#shopping_cart_dark_background"),n=document.querySelector("#shopping_cart_content"),o=document.querySelector("body");function c(){n.classList.contains("_active")&&n.classList.remove("_active"),i.classList.contains("_active")&&i.classList.remove("_active"),o.classList.contains("_no_scroll")&&(o.classList.remove("_no_scroll"),o.style.paddingRight="0px"),e.classList.contains("_transformed")&&e.classList.remove("_transformed")}t.addEventListener("click",(function(){c()})),i.addEventListener("click",(function(){i.classList.contains("_active")&&c()}))}addToCart(e){const i=document.querySelector("#"+e+"_image").childNodes[0],n=document.querySelector("#shopping_cart"),o=document.querySelector("body");i.classList.remove("_returned_normal");let c=i.getBoundingClientRect(),s=n.getBoundingClientRect();setTimeout((()=>{i.classList.remove("_transitioned"),o.classList.remove("_no_scroll"),o.style.paddingRight=0,n.style.paddingRight=0,i.removeAttribute("style"),i.style.transform="",i.classList.add("_returned_small")}),1100),setTimeout((()=>{i.classList.add("_transitioned"),i.classList.remove("_returned_small"),i.classList.add("_returned_normal")}),1500),i.classList.add("_transitioned"),o.classList.add("_no_scroll"),o.style.paddingRight=t+"px",n.style.paddingRight=t+"px";let l=s.left-c.left-n.offsetWidth/2,a=s.top-c.top-n.offsetWidth/4;i.style.transform="translateX("+l+"px) translateY("+a+"px) scale(0.1)"}};i.toFixPosition(),i.showCartContent(),i.closeCartContent(),window.addEventListener("scroll",(function(){i.toFixPosition()})),window.addEventListener("resize",(function(){i.toCenterItem()}));class n{constructor(e){this.menuPizzaName=e}openOrder(){$("#"+this.menuPizzaName+"_body").toggleClass("_active")}calcSum(){let e,t,i,n,o;e=0;let c=$("#"+this.menuPizzaName+"_form").children(".ingreds_checkbox").children("input:checked"),s=[];for(let e of c)s.push(parseInt(e.getAttribute("value")));for(let t of s)e+=t;t=$("#"+this.menuPizzaName+"_form").children(".dough_checkbox").children("input:checked").val(),i=$("#"+this.menuPizzaName+"_form").children(".size_checkbox").children("input:checked").val(),n=$("#"+this.menuPizzaName+"_form").children(".slice_checkbox").children("input:checked").val(),o=parseInt($("#"+this.menuPizzaName+"_price").attr("value")),o+=parseInt(t)+parseInt(i)+parseInt(n)+e,$("#"+this.menuPizzaName+"_price").text(o+" рублей")}selectOption(){const e=$("#"+this.menuPizzaName+"_form"),t=e.children(".checkbox_option").children("input:checked");for(let e of t){let t=e.getAttribute("id"),i=$('label[for="'+t+'"]');i.hasClass("_selected_option")||i.addClass("_selected_option")}const i=e.children(".checkbox_option").children(":not(input:checked)");for(let e of i){let t=e.getAttribute("id"),i=$('label[for="'+t+'"]');i.hasClass("_selected_option")&&i.removeClass("_selected_option")}}blockOptions(){let e=$("#"+this.menuPizzaName+"_slice1"),t=$("#"+this.menuPizzaName+"_size_checkbox").children("input:checked")[0].getAttribute("data-block-options");null!=t?(!function(){let i=t.split(", ");for(let e of i){$('label[for="'+e+'"]').addClass("_blocked_option")}for(let t of i){1==$("#"+t).prop("checked")&&e.prop("checked",!0)}for(let e of i){$("#"+e).prop("disabled",!0)}}(),this.selectOption()):function(e){let t=$("#"+e+"_slice_checkbox").children("input[disabled]");for(let e of t){let t=e.getAttribute("id");$("#"+t).prop("disabled",!1),$('label[for="'+t+'"]').removeClass("_blocked_option")}}(this.menuPizzaName)}}class o{constructor(e){this.menuDrinkName=e}calcSum(){let e,t,i,n,o=$("#"+this.menuDrinkName+"_form");e=o.children(".size_checkbox").children("input:checked").val(),e=parseInt(e),i=o.children(".taste_checkbox").children("input:checked").val(),i=void 0!==i?parseInt(i):0,n=o.children(".additional_checkbox").children("input:checked").val(),n=void 0!==n?parseInt(n):0,t=e+i+n,$("#"+this.menuDrinkName+"_price").text(t+" рублей")}changeImg(){let e=$("#"+this.menuDrinkName+"_form"),t=e.children(".size_checkbox").children("input:checked").attr("data-img-size"),i=e.children(".taste_checkbox").children("input:checked").attr("data-img-taste"),n=e.children(".additional_checkbox").children("input:checked").attr("data-img-additional");if(void 0!==i&&void 0!==n){let e="../img/menu/drinks/"+this.menuDrinkName+"/"+i+"_"+n+"_"+t+".png";$("#"+this.menuDrinkName+"_image").children("img").attr("src",e)}else if(void 0!==i){let e="../img/menu/drinks/"+this.menuDrinkName+"/"+i+"_"+t+".png";$("#"+this.menuDrinkName+"_image").children("img").attr("src",e)}else if(void 0!==n){let e="../img/menu/drinks/"+this.menuDrinkName+"/"+n+"_"+t+".png";$("#"+this.menuDrinkName+"_image").children("img").attr("src",e)}}drawBorder(){let e=$("#"+this.menuDrinkName+"_form").children();if(7==e.length){$("#"+this.menuDrinkName+"_form").children("div:nth-child(-n+2)").toggleClass("_bottom_border")}else if(8==e.length){$("#"+this.menuDrinkName+"_form").children("div:nth-child(-n+3)").toggleClass("_bottom_border")}}selectOption(){const e=$("#"+this.menuDrinkName+"_form"),t=e.children(".checkbox_option").children("input:checked");for(let e of t){let t=e.getAttribute("id"),i=$('label[for="'+t+'"]');i.hasClass("_selected_option")||i.addClass("_selected_option")}const i=e.children(".checkbox_option").children(":not(input:checked)");for(let e of i){let t=e.getAttribute("id"),i=$('label[for="'+t+'"]');i.hasClass("_selected_option")&&i.removeClass("_selected_option")}}blockOptions(){let e=$("#"+this.menuDrinkName+"_size_checkbox").children("input:checked").attr("data-block-options");null!=e?n(e,this.menuDrinkName):(e=$("#"+this.menuDrinkName+"_size_checkbox").children("input:checked").attr("data-unlock-options"),null!=e&&o());let t=$("#"+this.menuDrinkName+"_taste_checkbox").children("input:checked").attr("data-block-options");null!=t?n(t,this.menuDrinkName):(t=$("#"+this.menuDrinkName+"_taste_checkbox").children("input:checked").attr("data-unlock-options"),null!=t&&o(t));let i=$("#"+this.menuDrinkName+"_additional_checkbox").children("input:checked").attr("data-block-options");function n(e,t){for(let t of e.split(", "))$('label[for="'+t+'"]').addClass("_blocked_option");for(let t of e.split(", "))1==$("#"+t).prop("checked")&&setTimeout((()=>{$("#"+e).closest(".checkbox_option").children(":not(input[disabled])").prop("checked",!0)}),0),$("#"+t).prop("disabled",!0)}function o(e){for(let t of e.split(", "))$("#"+t).prop("disabled",!1),$('label[for="'+t+'"]').removeClass("_blocked_option")}null!=i?n(i,this.menuDrinkName):(i=$("#"+this.menuDrinkName+"_additional_checkbox").children("input:checked").attr("data-unlock-options"),null!=i&&o()),setTimeout((()=>{this.selectOption()}),0)}}const c=$(".pizza_image"),s=$(".drink_image");if(c.length>0)for(let e of c){let t=e.getAttribute("id").replace("_image",""),o=new n(t);o.calcSum(),o.selectOption(),$("#"+t+"_image").on("click",(function(){o.openOrder()})),$("#"+t+"_form").on("change",(function(){o.calcSum(),o.selectOption(),o.blockOptions()})),$("#"+t+"_order").on("click",(function(){i.addToCart(t)}))}if(s.length>0)for(let e of s){let t=e.getAttribute("id").replace("_image",""),n=new o(t);n.calcSum(),n.changeImg(),n.drawBorder(),n.selectOption(),$("#"+t+"_form").on("change",(function(){n.calcSum(),n.changeImg(),n.selectOption(),n.blockOptions()})),$("#"+t+"_order").on("click",(function(){i.addToCart(t)}))}let l=$(".feedback_item");const a=l.length-2;function r(e){let t=l.length-e;for(let e=1;e<=t;e++)$(".feedback_item:nth-child("+e+")").toggleClass("_hidden");$(".feedback_item._hidden").length>0?$(".feedback_item:nth-child("+a+")").addClass("_no_margin"):$(".feedback_item:nth-child("+a+")").removeClass("_no_margin"),$("#feedbacks_amount_text").text(e)}function d(){let e=$(".feedback_item._hidden"),t=$(".feedback_item");t.length<=3?($("#feedbacks_shown_text").text("Вам показаны все отзывы ("+t.length+")"),$("#feedback_button").toggleClass("_hidden")):e.length>0?($("#feedbacks_shown_text").text("Вам показаны 3 последних отзыва"),$("#feedback_button").text("Показать все отзывы")):($("#feedbacks_shown_text").text("Вам показаны все отзывы ("+t.length+")"),$("#feedback_button").text("Вернуть 3 последних отзыва"))}r(3),d(),$("#feedback_button").on("click",(function(){r(3),d()}))}),100)}));